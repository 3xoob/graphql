{"version":3,"file":"profilePage.js","sourceRoot":"","sources":["../../src/app/profilePage.ts"],"names":[],"mappings":"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","sourcesContent":["import { renderLoginPage } from \"./loginPage\";\nimport { renderProfileCard } from \"./userInfo\";\nimport { renderSkillsCharts } from \"./skillChart\"\nimport { renderAuditCard } from \"./auditCard\";\nimport { displayRankCard } from \"./UserRank\"\nimport { renderAuditTable } from \"./auditTable\"\nimport { renderXPCard } from \"./xpCard\";\nimport { renderLogoutBtn } from \"./logoutBtn\";\nimport { UserAttributes } from \"../types\";\nimport { GET_USER_INFO } from \"./queries\";\n\n// Fetch and display user information with access control\nexport async function renderProfilePage() {\n    const jwt = localStorage.getItem(\"jwt\");\n    if (!jwt || jwt.split(\".\").length !== 3) {\n        history.pushState(null, \"\", \"/login\");\n        renderLoginPage();\n        return;\n    }\n\n    const app = document.getElementById(\"app\");\n    if (!app) {\n        console.error(\"App container not found!\");\n        return;\n    }\n\n    app.innerHTML = '';\n\n    try {\n        const response = await fetch(\"https://learn.reboot01.com/api/graphql-engine/v1/graphql\", {\n            method: \"POST\",\n            headers: {\n                Authorization: `Bearer ${jwt}`,\n                \"Content-Type\": \"application/json\",\n            },\n            body: JSON.stringify({\n                query: GET_USER_INFO,\n            }),\n        });\n\n        if (!response.ok) {\n            app.innerHTML += '<p>Error: Failed to fetch user data.</p>';\n            return;\n        }\n\n        const result = await response.json();\n\n        if (result.errors) {\n            console.error(\"GraphQL Errors:\", result.errors);\n            app.innerHTML += '<p>Error: GraphQL Errors occurred.</p>';\n            return;\n        }\n\n        const userInfo = result.data?.user;\n        if (Array.isArray(userInfo) && userInfo.length > 0) {\n            const userAttributes = userInfo[0].attrs;\n            userAttributes.username = userInfo[0].login\n            userAttributes.campus = userInfo[0].campus\n            renderUI(userAttributes);\n        } else {\n            app.innerHTML += '<p>No user info found.</p>';\n        }\n    } catch (error) {\n        console.error(\"Error fetching user info:\", error);\n        app.innerHTML += '<p>Error: Unable to fetch user info.</p>';\n    }\n}\n\n// Function to render all the cards of the user (UI)\nexport async function renderUI(user: UserAttributes) {\n    const app = document.getElementById(\"app\");\n    if (!app) {\n        console.error(\"App container not found!\");\n        return;\n    }\n\n    const ProfileContainer = document.createElement(\"div\");\n    ProfileContainer.className = \"ProfileContainer\";\n    ProfileContainer.id = \"ProfileContainer\"\n\n    app.innerHTML = '';\n    app.append(ProfileContainer)\n\n    const welcome_info = document.createElement(\"div\");\n    welcome_info.id = \"welcome_info\";\n\n    ProfileContainer.append(welcome_info);\n\n    const topDiv = document.createElement(\"div\");\n    topDiv.id = \"topDiv\";\n    ProfileContainer.append(topDiv);\n\n    const lowDiv = document.createElement(\"div\");\n    lowDiv.id = \"lowDiv\";\n\n    ProfileContainer.append(lowDiv);\n\n    renderProfileCard(user);\n    renderLogoutBtn();\n    displayRankCard();\n\n    const TwoElem = document.createElement(\"div\");\n    TwoElem.id = \"TwoElem\";\n    topDiv.append(TwoElem);\n\n    renderAuditTable();\n    renderAuditCard();\n    renderXPCard();\n    renderSkillsCharts();\n}\n"]}